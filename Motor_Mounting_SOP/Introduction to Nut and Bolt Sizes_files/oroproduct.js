(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/list-item-prices-tier-table.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+="",_.keys(prices).length?(__p+='\n<table class="table">\n    <thead>\n    <tr>\n        <th class="text-uppercase">'+(null==(__t=_.__("oro.pricing.qty"))?"":_.escape(__t))+"</th>\n        <th>"+(null==(__t=_.__("oro.pricing.unit_price"))?"":_.escape(__t))+"</th>\n    </tr>\n    </thead>\n    <tbody>\n    ",_.each(prices,function(e,t){__p+='\n    <tr>\n        <td colspan="2" class="text-center">\n            <strong>'+(null==(__t=_.__("oro.product.product_unit."+t+".label.full"))?"":_.escape(__t))+"</strong>\n        </td>\n    </tr>\n    ",_.each(e,function(e){__p+="\n    <tr>\n        <td>"+(null==(__t=e.quantity)?"":_.escape(__t))+"</td>\n        <td>\n            "+(null==(__t=formatter.formatCurrency(e.price,e.currency))?"":_.escape(__t))+"\n        </td>\n    </tr>\n    "}),__p+="\n    "}),__p+="\n    </tbody>\n</table>\n"):__p+="\n    "+(null==(__t=_.__("oro.pricing.product_prices.price_not_found"))?"":_.escape(__t))+"\n",__p+="\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/list-item-product-prices.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){__p+="";var maxFractionDigits=localeSettings.getNumberFormats("currency").max_fraction_digits;__p+="\n",null===price?__p+='\n<div class="product-price__not_found">'+(null==(__t=_.__("oro.pricing.product_prices.price_not_found"))?"":_.escape(__t))+"</div>\n":(__p+="\n",!1!==showValuePrice&&(__p+='\n<div class="product-price__your" data-name="price">\n    <span class="product-price__label">'+(null==(__t=_.__("oro.pricing.product_prices.your_price"))?"":_.escape(__t))+'</span>\n    <span class="product-price__main-box">\n        <span class="product-price__value" data-name="price-value" itemscope="itemscope" itemtype="http://schema.org/Offer" itemprop="offers">\n            <meta itemprop="priceCurrency" content="'+(null==(__t=price.currency)?"":_.escape(__t))+'"/><meta itemprop="price" content="'+(null==(__t=numeral(price.price).format("0.00"))?"":_.escape(__t))+'"/>'+(null==(__t=price.formatted_price.trim())?"":_.escape(__t))+'\n        </span>\n        <span> / </span>\n        <span class="product-price__unit" data-name="unit">\n            <span class="product-price__unit-full">\n                '+(null==(__t=_.__("oro.product.product_unit."+price.unit+".label.full"))?"":_.escape(__t))+'\n            </span>\n            <span class="product-price__unit-short">\n                '+(null==(__t=_.__("oro.product.product_unit."+price.unit+".label.short"))?"":_.escape(__t))+"\n            </span>\n        </span>\n    </span>\n</div>\n"),__p+="\n",!1!==showListedPrice&&(__p+='\n<div class="product-price__listed">\n    <span class="product-price__listed-label">'+(null==(__t=_.__("oro.pricing.product_prices.listed_price"))?"":_.escape(__t))+"</span>\n    ",_.each(listedPrice,function(e,t){__p+='\n    <span class="product-price__listed-box" title="'+(null==(__t=_.__("oro.pricing.product_prices.applicable_from",{amount:e.quantity}))?"":_.escape(__t))+'">\n        <span class="product-price__listed-value">'+(null==(__t=e.formatted_price)?"":_.escape(__t))+'</span>\n        <span> / </span>\n        <span class="product-price__unit" data-name="unit">\n            <span class="product-price__unit-full">\n                '+(null==(__t=_.__("oro.product.product_unit."+e.unit+".label.full"))?"":_.escape(__t))+'\n            </span>\n            <span class="product-price__unit-short">\n                '+(null==(__t=_.__("oro.product.product_unit."+e.unit+".label.short"))?"":_.escape(__t))+"\n            </span>\n        </span>\n    </span>\n    "}),__p+="\n</div>\n"),__p+="\n"),__p+="\n"}return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/price.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<meta itemprop="priceCurrency" content="'+(null==(__t=price.currency)?"":_.escape(__t))+'"/><meta itemprop="price" content="'+(null==(__t=numeral(price.price).format("0.00"))?"":_.escape(__t))+'"/>'+(null==(__t=price.formatted_price.trim())?"":__t)+"\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-price-overridden.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="product-price-overridden" style="display: none;">\n    <i class="fa-info-circle"\n       data-toggle="popover"\n       data-placement="bottom"\n       data-close="false"\n       data-class="product-price-hint"\n       data-content="'+(null==(__t=["<div class='hint-title'>",_.__("oro.pricing.product_prices.price_is_overridden"),"</div>","<a class='btn' href='#'>","<span class='fa-refresh'></span>",_.__("oro.pricing.product_prices.reset_price"),"</a>"].join(""))?"":__t)+'">\n    </i>\n</div>\n';return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-tier-button.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="add-on btn btn-icon btn-square-default product-tier-prices"\n     data-class="prices-tier-popover"\n     role="button"\n     aria-label="'+(null==(__t=_.__("oro.pricing.view_all_prices"))?"":_.escape(__t))+'"\n    >\n    <span class="fa-bars"\n       data-toggle="popover"\n       data-placement="bottom"\n       data-close="false"\n       aria-hidden="true"\n    ></span>\n</div>\n';return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-tier-table.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<div class="prices-tier">\n    ',clickable&&(__p+='\n    <h3 class="prices-tier-title">'+(null==(__t=_.__("oro.pricing.click_to_select"))?"":_.escape(__t))+"</h3>\n    "),__p+='\n    <table class="table">\n        ',clickable&&(__p+='\n        <thead>\n            <tr>\n                <th class="text-uppercase">'+(null==(__t=_.__("oro.pricing.qty"))?"":_.escape(__t))+"</th>\n                <th>"+(null==(__t=_.__("oro.pricing.unit_price"))?"":_.escape(__t))+"</th>\n            </tr>\n        </thead>\n        "),__p+="\n        <tbody>\n        ",_.each(prices,function(e,t){__p+='\n        <tr>\n            <td colspan="2">\n                <b>'+(null==(__t=_.__("oro.product.product_unit."+t+".label.full"))?"":_.escape(__t))+"</b>\n            </td>\n        </tr>\n        ",_.each(e,function(e){__p+='\n        <tr class="',_.isEmpty(matchedPrice)||t!==matchedPrice.unit||parseFloat(e.price)!==parseFloat(matchedPrice.price)||(__p+="matched-tier-price"),__p+='">\n            <td>'+(null==(__t=e.quantity)?"":_.escape(__t))+"</td>\n            <td>\n                ",clickable?(__p+='\n                <a href="#" data-price="'+(null==(__t=parseFloat(e.price))?"":_.escape(__t))+'"\n                   data-unit="'+(null==(__t=t)?"":_.escape(__t))+'"\n                   role="button"\n                   data-emulate-btn-press=""\n                ',ariaControlsId&&(__p+='\n                aria-controls="'+(null==(__t=ariaControlsId)?"":_.escape(__t))+'"\n                '),__p+="\n                > "+(null==(__t=formatter.formatCurrency(e.price,e.currency))?"":_.escape(__t))+"</a>\n                "):__p+="\n                    "+(null==(__t=formatter.formatCurrency(e.price,e.currency))?"":_.escape(__t))+"\n                ",__p+="\n            </td>\n        </tr>\n        "}),__p+="\n        "}),__p+="\n        </tbody>\n    </table>\n</div>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/unit.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{})__p+='<span class="product-price__unit-full">\n    '+(null==(__t=_.__("oro.product.product_unit."+price.unit+".label.full"))?"":_.escape(__t))+'\n</span>\n<span class="product-price__unit-short">\n    '+(null==(__t=_.__("oro.product.product_unit."+price.unit+".label.short"))?"":_.escape(__t))+"\n</span>\n";return __p}},"../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroproduct/templates/search-autocomplete.html":function(module,exports,__webpack_require__){var _=__webpack_require__("./bundles/oroui/js/extend/underscore.js");module.exports=function(obj){var __t,__p="",__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,"")};with(obj||{}){function highlightWords(e,t){if(e&&_.isString(e)){const i='<span class="search-autocomplete__highlight">$&</span>',n=_.escape(e).split(" "),o=new RegExp(n.join("|"),"gi");return _.escape(t).replace(o,i)}return _.escape(t)}__p+="",__p+='\n\n<div class="search-autocomplete">\n    <div class="search-autocomplete__content dropdown-menu" id="'+(null==(__t=comboboxId)?"":_.escape(__t))+'" role="listbox">\n        ',total_count>0?(__p+='\n            <ul class="search-autocomplete__list" role="presentation">\n                ',_.each(products,function(e){__p+='\n                    <li class="search-autocomplete__item" role="option">\n                        <a href="'+(null==(__t=e.url)?"":_.escape(__t))+'" class="search-autocomplete-product" title="'+(null==(__t=e.name)?"":_.escape(__t))+'">\n                            <div class="search-autocomplete-product__image">\n                                <img src="'+(null==(__t=e.image)?"":_.escape(__t))+'" alt="'+(null==(__t=e.name)?"":_.escape(__t))+'">\n                            </div>\n                            <div class="search-autocomplete-product__info">\n                                <div class="search-autocomplete-product__head">\n                                    <div class="search-autocomplete-product__title">'+(null==(__t=highlightWords(inputString,e.name))?"":__t)+"</div>\n                                    ",e.formatted_price&&(__p+='\n                                        <div class="search-autocomplete-product__price">'+(null==(__t=e.formatted_price)?"":_.escape(__t))+"</div>\n                                    "),__p+='\n                                </div>\n                                <div class="search-autocomplete-product__body">\n                                    <div class="search-autocomplete-product__sku">'+(null==(__t=highlightWords(inputString,e.sku))?"":__t)+'</div>\n                                    <div class="search-autocomplete-product__status '+(null==(__t=e.inventory_status)?"":_.escape(__t))+'">'+(null==(__t=e.inventory_status_label)?"":_.escape(__t))+"</div>\n                                </div>\n                            </div>\n                        </a>\n                    </li>\n                "}),__p+='\n            </ul>\n            <div class="search-autocomplete__footer" role="option">\n                <button class="btn btn--link btn--no-offset search-autocomplete__submit" type="submit">'+(null==(__t=_.__("oro.product.autocomplete.popup.button.all.label",{productCount:total_count},total_count))?"":_.escape(__t))+' <span class="fa-angle-right" aria-hidden="true"></span></button>\n            </div>\n        '):__p+='\n            <div class="search-autocomplete__no-found">'+(null==(__t=_.__("oro.product.autocomplete.no_found"))?"":_.escape(__t))+"</div>\n        ",__p+="\n    </div>\n</div>\n"}return __p}},"./bundles/orofrontend/js/app/views/fit-matrix-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.join.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/oroui/js/extend/underscore.js"),o=t.extend({$matrixContainer:null,$scrollView:null,listen:{"layout:reposition mediator":"fitMatrix"},states:["state-labels-above","state-multiline"],constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){o.__super__.initialize.call(this,e),this.$matrixContainer=this.$("[data-matrix-grid-container]"),this.$scrollView=this.$("[data-scroll-view]"),this.fitMatrix(),this.fitMatrix=n.debounce(this.fitMatrix,100).bind(this)},fitMatrix:function(){this.resetState();for(var e=0;e<this.states.length;e++){if(!this.isFittedContainer())return;this.resetState(),this.$matrixContainer.addClass(this.states[e])}},isFittedContainer:function(){var e=this.$scrollView.get(0);return e.clientWidth<e.scrollWidth},resetState:function(){this.$matrixContainer.removeClass(this.states.join(" "))},dispose:function(){this.disposed||(delete this.$matrixContainer,delete this.$row,o.__super__.dispose.call(this))}});return o}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/components/currency-switcher-component.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/oroui/js/mediator.js"),o=i("./bundles/oroui/js/extend/underscore.js"),s=i("./bundles/oroui/js/extend/jquery.js"),r=i("./bundles/fosjsrouting/js/router.js"),a=t.extend({options:{currencySwitcherRoute:"oro_pricing_frontend_set_current_currency",currencyElement:"[data-currency]",selectedCurrency:null},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=o.defaults(e||{},this.options),this.options._sourceElement.on("click",this.options.currencyElement,o.bind(this.onCurrencyChange,this))},onCurrencyChange:function(e){var t=this;e.preventDefault();var i=s(e.target).data("currency"),o=this.options.selectedCurrency;n.execute("showLoading"),this.syncActiveCurrency(i).then(function(){return n.execute("refreshPage")}).fail(function(){t.syncActiveCurrency(o).done(function(){return n.execute("hideLoading")})})},syncActiveCurrency:function(e){var t=r.generate(this.options.currencySwitcherRoute);return s.post(t,{currency:e})},dispose:function(){this.disposed||(this.options._sourceElement.off(),a.__super__.dispose.call(this))}});return a}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/components/list-item-product-prices-component.js":function(e,t,i){"use strict";i.r(t);i("../node_modules/core-js/modules/es.object.keys.js"),i("../node_modules/core-js/modules/es.symbol.js"),i("../node_modules/core-js/modules/es.array.filter.js"),i("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),i("../node_modules/core-js/modules/web.dom-collections.for-each.js"),i("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js");var n=i("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=i.n(n),s=(i("../node_modules/core-js/modules/es.object.assign.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.promise.js"),i("../node_modules/core-js/modules/es.promise.finally.js"),i("../node_modules/core-js/modules/es.array.find.js"),i("./bundles/oroui/js/extend/underscore.js")),r=i.n(s),a=i("./bundles/oroui/js/tools.js"),l=i.n(a),u=i("./bundles/fosjsrouting/js/router.js"),c=i.n(u),d=i("./bundles/oroui/js/app/components/base/component.js"),p=i.n(d),h=i("./bundles/orolocale/js/locale-settings.js"),_=i.n(h),m=i("./bundles/oroui/js/error.js"),f=i.n(m),g=i("./bundles/oropricing/js/app/views/list-item-product-prices-view.js"),b=i.n(g);function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function v(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach(function(t){o()(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var y=p.a.extend({tierPricesRoute:"oro_pricing_frontend_price_by_customer",productId:void 0,viewOptions:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){Object.assign(this,r.a.pick(e,"tierPricesRoute","productId")),this.viewOptions=v({el:e._sourceElement},r.a.pick(e,"showValuePrice","showListedPrice","doUpdateQtyForUnit","elements")),this.loadPrices()},loadPrices:function(){var e=this;this.viewOptions.el.addClass("loader-in-process");var t={currency:_.a.getCurrency(),product_ids:[this.productId]},i=c.a.generate(this.tierPricesRoute,t);fetch(i).then(function(e){return e.json()}).then(function(t){return e.onPricesLoad(t[e.productId]||{})}).catch(function(){return f.a.showErrorInConsole(new Error("Unable to load prices for ".concat(e.productId," product")))}).finally(function(){e.viewOptions.el.removeClass("loader-in-process"),l.a.isIE11()&&e.viewOptions.el.find(".fa--loader-icon").css("display")})},onPricesLoad:function(e){this.view=new b.a(v(v({},this.viewOptions),{},{modelAttr:{prices:e}})),this.view.getElement("pricesHint").click()}});t.default=y},"./bundles/oropricing/js/app/prices-helper.js":function(e,t,i){var n,o=i("../node_modules/@babel/runtime/helpers/slicedToArray.js"),s=i("../node_modules/@babel/runtime/helpers/defineProperty.js"),r=i("../node_modules/@babel/runtime/helpers/toConsumableArray.js");i("../node_modules/core-js/modules/es.array.sort.js"),i("../node_modules/core-js/modules/es.object.keys.js"),i("../node_modules/core-js/modules/es.object.values.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.object.entries.js"),i("../node_modules/core-js/modules/web.dom-collections.for-each.js"),i("../node_modules/core-js/modules/es.array.concat.js"),i("../node_modules/core-js/modules/es.array.find.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/orolocale/js/numeral-l10n.js"),a={sortByLowQuantity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return!t.isArray(e)||e.length<2?e:r(e).sort(function(e,t){return e.quantity<t.quantity?-1:1})},sortUnitPricesByLowQuantity:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.keys(e)[0],i=Object.values(e)[0];return s({},t,a.sortByLowQuantity(i))},preparePrices:function(e){e=(e=t.sortBy(e,"quantity")).reverse();var i={};return t.each(e,function(e){var t=e.unit;i[t]=i[t]||[],i[t].push(e)}),i},indexPrices:function(e){return Object.entries(e).reduce(function(e,t){var i=o(t,2),n=i[0];return i[1].forEach(function(t){return e["".concat(n,"_").concat(t.quantity)]=t}),e},{})},findPrice:function(e,i,n){return t.isEmpty(e)||isNaN(n)||""===n?null:(n=parseFloat(n))<0?null:t.find(e[i],function(e){return e.quantity<=n})||null},findPriceValue:function(e,t,i){var n=this.findPrice(e,t,i);return n?n.price:0},calcTotalPrice:function(e,t,i){return n(this.findPriceValue(e,t,i)).multiply(i).value()}};return a}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/base-product-matrix-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.concat.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.regexp.to-string.js"),i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.number.max-safe-integer.js"),i("../node_modules/core-js/modules/es.number.constructor.js"),i("../node_modules/core-js/modules/es.array.filter.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/orolocale/js/formatter/number.js"),o=i("./bundles/oropricing/js/app/prices-helper.js"),s=i("./bundles/orofrontend/js/app/views/scroll-view.js"),r=i("./bundles/orofrontend/js/app/views/fit-matrix-view.js"),a=i("./bundles/oroproduct/js/app/quantity-helper.js"),l=i("./bundles/orolocale/js/numeral-l10n.js"),u=i("./bundles/oroui/js/extend/jquery.js"),c=i("./bundles/oroui/js/extend/underscore.js"),d=t.extend({autoRender:!1,optionNames:t.prototype.optionNames.concat(["dimension"]),events:{'input [data-name="field__quantity"]:enabled':"_onQuantityChange",'change [data-name="field__quantity"]:enabled':"_onQuantityChange",'click [data-role="clear"]':"clearForm"},total:null,prices:null,minValue:1,dimension:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){d.__super__.initialize.call(this,e),this.initModel(e),this.setPrices(e),c.isDesktop()&&(1===this.dimension?this.subview("fitMatrixView",new r({el:this.el})):this.subview("scrollView",new s({el:this.el}))),this.setDefaultTotals(),this.updateTotals()},initModel:function(e){e.productModel&&(this.model=e.productModel)},dispose:function(){delete this.prices,delete this.total,delete this.minValue,d.__super__.dispose.call(this)},setDefaultTotals:function(){this.total={price:0,quantity:0,rows:{},columns:{},cells:{}}},setPrices:function(e){this.prices={},e.prices&&!c.isObject(e.prices)&&(e.prices=JSON.parse(e.prices)),c.each(e.prices,function(e,t){this.prices[t]=o.preparePrices(e)},this)},_onQuantityChange:function(e){if(!this._isSafeNumber(e.currentTarget.value))return e.preventDefault(),!1;this.updateTotal(u(e.currentTarget)),this.checkClearButtonVisibility(),this.render()},updateTotals:function(){c.each(this.$('[data-name="field__quantity"]:enabled'),function(e){this.updateTotal(u(e))},this)},updateTotal:function(e){var t=e.closest("[data-index]"),i=t.data("index"),s=t.data("product-id"),r=i.row+"."+i.column,a=this.total.cells,l=this.total.columns,u=this.total.rows,c=a[r]=this.getTotal(a,r),d=l[i.column]=this.getTotal(l,i.column);d.precision=this.getLineMaxPrecision("column",i);var p=u[i.row]=this.getTotal(u,i.row);p.precision=this.getLineMaxPrecision("row",i),void 0===this.total.precision&&(this.total.precision=this.getMatrixMaxPrecision()),this.changeTotal(this.total,c,-1),this.changeTotal(d,c,-1),this.changeTotal(p,c,-1),c.quantity=n.unformatStrict(e.val());var h=c.quantity>0?c.quantity.toString():"";c.price=o.calcTotalPrice(this.prices[s],this.model.get("unit"),h),this.changeTotal(this.total,c),this.changeTotal(d,c),this.changeTotal(p,c)},getLineMaxPrecision:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,i=c.reduce(this.$el.find('[data-name="field__quantity"]:enabled'),function(i,n){var o=u(n).data("precision");return u(n).closest("[data-index]").data("index")[e]===t[e]&&void 0!==o&&i.push(o),i},[]);return this.getMaxValue(i)},getMatrixMaxPrecision:function(){var e=c.reduce(this.$el.find('[data-name="field__quantity"]:enabled'),function(e,t){var i=u(t).data("precision");return void 0!==i&&e.push(i),e},[]);return this.getMaxValue(e)},getMaxValue:function(e){return e.length?Math.max.apply(null,e):null},getTotal:function(e,t){return e[t]||{quantity:0,price:0}},changeTotal:function(e,t,i){i=i||1,e.quantity=l(t.quantity).multiply(i).add(e.quantity).value(),e.price=l(t.price).multiply(i).add(e.price).value(),"NaN"===n.formatDecimal(e.price)&&(e.price=0)},getValidQuantity:function(e){var t=parseInt(e,10)||0;return c.isEmpty(e)?0:t<this.minValue?this.minValue:t},render:function(){this.$('[data-role="total-quantity"]').text(this.formatQuantity(this.total.quantity,this.total.precision)),this.$('[data-role="total-price"]').text(n.formatCurrency(this.total.price,this.total.currency)),c.each(c.pick(this.total,"rows","columns"),this.renderSubTotals,this)},renderSubTotals:function(e,t){c.each(e,function(e,i){var o=this.$el.find("[data-"+t+'-quantity="'+i+'"]'),s=this.$el.find("[data-"+t+'-price="'+i+'"]');o.toggleClass("valid",e.quantity>0).text(this.formatQuantity(e.quantity,e.precision)),s.toggleClass("valid",e.price>0).text(n.formatCurrency(e.price,e.currency))},this)},formatQuantity:function(e,t){var i=[e];return c.isNumber(t)&&i.push(t),a.formatQuantity.apply(null,i)},_isSafeNumber:function(e){return n.unformatStrict(""===e?0:e)<=Number.MAX_SAFE_INTEGER},checkClearButtonVisibility:function(){var e=c.every(this.$('[data-name="field__quantity"]:enabled'),function(e){return c.isEmpty(e.value)});this.$('[data-role="clear"]').toggleClass("disabled",e)},clearForm:function(){this.$('[data-name="field__quantity"]:enabled').filter(function(){return this.value.length>0}).val("").trigger("change")}});return d}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/base-product-prices-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.concat.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.regexp.to-string.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/orofrontend/js/app/elements-helper.js"),o=i("./bundles/oroui/js/layout.js"),s=i("./bundles/oroui/js/mediator.js"),r=i("./bundles/orolocale/js/formatter/number.js"),a=i("./bundles/orolocale/js/numeral-l10n.js"),l=i("./bundles/orolocale/js/locale-settings.js"),u=i("./bundles/oroui/js/app/models/base/model.js"),c=i("./bundles/oropricing/js/app/prices-helper.js"),d=i("../node_modules/bootstrap/js/dist/popover.js"),p=i("./bundles/oroui/js/extend/underscore.js"),h=i("./bundles/oroui/js/extend/jquery.js"),_=t.extend(p.extend({},n,{priceTemplate:i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/price.html"),unitTemplate:i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/unit.html"),keepElement:!0,optionNames:t.prototype.optionNames.concat(["changeQuantity","changeUnitLabel"]),options:{defaultQuantity:1},elements:{price:'[data-name="price"]',unit:'[data-name="unit"]',priceValue:'[data-name="price-value"]',priceNotFound:'[data-name="price-not-found"]',pricesHint:'[data-name="prices-hint"]',pricesHintContent:'[data-name="prices-hint-content"]'},modelAttr:{prices:{},price:0},modelEvents:{"prices setPrices":["change","setPrices"],"quantity setFoundPrice":["change","onQuantityChange"],"unit setFoundPrice":["change","onUnitChange"],"price updateUI":["change","updateUI"]},prices:null,foundPrice:null,changeQuantity:!1,changeUnitLabel:!1,rendered:!1,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){_.__super__.initialize.call(this,e),this.deferredInitializeCheck(e,["productModel"])},deferredInitialize:function(e){this.initModel(e),this.model&&(this.initializeElements(e),this.render())},dispose:function(){delete this.modelAttr,delete this.prices,delete this.foundPrice,this.setUnitLabel(!0),this.disposeElements(),_.__super__.dispose.call(this)},render:function(){this.setPrices()},initModel:function(e){this.modelAttr=h.extend(!0,{},this.modelAttr,e.modelAttr||{}),e.productModel&&(this.model=e.productModel),this.model||(this.model=new u),p.each(this.modelAttr,function(e,t){this.model.has(t)&&p.isEmpty(e)||this.model.set(t,e)},this)},renderHint:function(){var e=this.getElement("pricesHint");if(e.length){var t=this.getHintContent();e.toggleClass("disabled",0===t.length).attr("disabled",0===t.length),t.length&&(e.data(d.DATA_KEY)||o.initPopoverForElements(e,{container:"body",forceToShowTitle:!0},!0),e.data(d.DATA_KEY).updateContent(t))}},getHintContent:function(){return this.getElement("pricesHintContent").html()||""},setPrices:function(){this.prices=c.preparePrices(this.model.get("prices")),this.foundPrice={},this.rendered?this.setFoundPrice():(this.setFoundPrice(!0),this.rendered||this.updateUI())},onQuantityChange:function(e){this.setFoundPrice()},onUnitChange:function(e){this.setFoundPrice(e.manually||!1)},setUnitLabel:function(e){if(this.changeUnitLabel){var t=this.model.get("price"),i=null;!e&&t&&(i=p.__("oro.pricing.price.formatted.unit",{formattedUnit:p(t.formatted_unit).capitalize(),formattedPrice:t.formatted_price})),this.model.set("unit_label",i)}},setFoundPrice:function(e){this.setPriceValue(this.findPrice(e))},setPriceValue:function(e){this.model.set("price",e),this.setUnitLabel()},findPrice:function(e){this.model.get("quantity_changed_manually")&&(this.changeQuantity=!1);var t=this.model.get("quantity"),i=this.model.get("unit"),n=i+" "+t+" "+((e=e&&this.changeQuantity)?1:0),o=this.foundPrice[n]||null;if(o||(o=e?p.last(this.prices[i])||null:c.findPrice(this.prices,i,t),this.foundPrice[n]=o),e){var s=o?o.quantity:this.options.defaultQuantity;t.toString()!==s.toString()&&this.model.set("quantity",s)}return o},findPriceValue:function(){var e=this.findPrice();return e?e.price:null},updateUI:function(){this.rendered=!0;var e=this.model.get("price");null===e?(this.getElement("price").addClass("hidden"),this.getElement("priceNotFound").removeClass("hidden")):(this.getElement("unit").html(this.unitTemplate({price:e})),this.getElement("priceValue").html(this.priceTemplate({price:e,numberFormatter:r,localeSettings:l,numeral:a})),this.getElement("priceNotFound").addClass("hidden"),this.getElement("price").removeClass("hidden")),this.renderHint(),s.trigger("layout:reposition")}}));return _}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/line-item-product-prices-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.filter.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.find.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/oroui/js/extend/jquery.js"),o=i("./bundles/oroui/js/mediator.js"),s=i("./bundles/oropricing/js/app/views/product-prices-editable-view.js"),r=s.extend({elements:t.extend({},s.prototype.elements,{currency:'[data-name="field__currency"]'}),modelElements:t.extend({},s.prototype.modelElements,{currency:"currency"}),modelEvents:t.extend({},s.prototype.modelEvents,{"id updateTierPrices":["change","updateTierPrices"],"currency updatePriceValue":["change","updatePriceValue"],"unit updatePriceValue":["change","updatePriceValue"],"quantity updatePriceValue":["change","updatePriceValue"]}),storedValues:{},constructor:function e(t){e.__super__.constructor.call(this,t)},deferredInitialize:function(e){if(r.__super__.deferredInitialize.call(this,e),!this.options.editable){this.getElement("priceValue").prop("readonly",!0);var i=this.model.get("id");!t.isUndefined(i)&&i.length&&this.model.get("price")&&(this.storedValues=t.extend({},this.model.attributes))}o.on("pricing:collect:line-items",this.collectLineItems,this),o.on("pricing:refresh:products-tier-prices",this.refreshTierPrices,this),o.on("pricing:currency:changed",this.currencyChanged,this),o.trigger("pricing:currency:load",t.bind(this.currencyChanged,this)),o.trigger("pricing:get:products-tier-prices",t.bind(function(e){var i=this.model.get("id");!t.isUndefined(i)&&t.isUndefined(e[i])&&this.updateTierPrices(),this.setTierPrices(e,!1)},this))},updateTierPrices:function(){var e=this.model.get("id");0===e.length?this.refreshTierPrices({}):o.trigger("pricing:load:products-tier-prices",[e],t.bind(this.refreshTierPrices,this))},setTierPrices:function(e,i){this.tierPrices=e;var n={},o=this.model.get("id");t.isUndefined(o)||0===o.length||(n=e[o]||{});var s=this.model.get("currency");s&&(n=t.filter(n,function(e){return e.currency===s})),this.model.set("prices",n,{silent:i||!1})},refreshTierPrices:function(e){var t=this.model.get("id");this.setTierPrices(e,!1),this.options.editable||(this.filterValues(),t&&this.updatePriceValue())},collectLineItems:function(e){var i=this.model.get("id");!t.isUndefined(i)&&i.length&&e.push({product:i,unit:this.model.get("unit"),quantity:this.model.get("quantity"),currency:this.model.get("currency")})},filterValues:function(){var e=this.model.get("id"),i={};t.isUndefined(e)||0===e.length||(i=this.tierPrices[e]||{});var o=[],s=[];t.each(i,function(e){o.push(e.currency),s.push(e.unit)}),t.isUndefined(this.storedValues.price)?(t.isUndefined(e)||0===e.length)&&(o.push(this.model.get("currency")),s.push(this.model.get("unit"))):(o.push(this.storedValues.currency),s.push(this.storedValues.unit)),this.getElement("currency").find("option").filter(function(){return-1===n.inArray(this.value,o)}).remove(),this.model.trigger("product:unit:filter-values",s)},updatePriceValue:function(){var e;(this.setTierPrices(this.tierPrices),this.options.editable)||(e=this.storedValues&&this.model.get("id")===this.storedValues.id&&this.model.get("unit")===this.storedValues.unit&&this.model.get("quantity")===this.storedValues.quantity&&this.model.get("currency")===this.storedValues.currency?this.storedValues:this.findPrice(),this.setPriceValue(e?e.price:null),this.getElement("priceValue").addClass("matched-price"))},currencyChanged:function(e){e.currency&&this.model.set("currency",e.currency)},dispose:function(){this.disposed||(o.off(null,null,this),delete this.storedValues,r.__super__.dispose.call(this))}});return r}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/list-item-product-prices-subview.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/oroui/js/mediator.js"),o=i("./bundles/orolocale/js/numeral-l10n.js"),s=i("./bundles/orolocale/js/locale-settings.js"),r=i("./bundles/oropricing/js/app/prices-helper.js"),a=i("./bundles/oroui/js/extend/underscore.js"),l=t.extend({template:i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/list-item-product-prices.html"),modelAttr:{listedPrice:null},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){l.__super__.initialize.call(this,e),this.showListedPrice=e.showListedPrice,this.showValuePrice=e.showValuePrice,this.changeUnitLabel=e.changeUnitLabel,a.each(this.modelAttr,function(e,t){this.model.set(t,e)},this),this.model.on("change:pricesByUnit",this.render,this),this.model.on("change:quantity",this.render,this),this.model.on("change:unit",this.render,this)},dispose:function(){this.model&&this.model.off(null,null,this),l.__super__.dispose.call(this)},getTemplateData:function(){return{listedPrice:this.findListedPrice(),price:this.findPrice(),localeSettings:s,numeral:o,showValuePrice:this.showValuePrice,showListedPrice:this.showListedPrice}},setUnitLabel:function(){if(this.changeUnitLabel){var e=this.findPrice(),t=null;e&&(t=a.__("oro.pricing.price.formatted.unit",{formattedUnit:a(e.formatted_unit).capitalize(),formattedPrice:e.formatted_price})),this.model.set("unit_label",t)}},render:function(){return l.__super__.render.call(this),this.setUnitLabel(),n.trigger("layout:reposition"),this},findPrice:function(){if(!this.showValuePrice)return null;var e=this.model.get("quantity"),t=this.model.get("unit"),i=this.model.get("pricesByUnit");return r.findPrice(i,t,e)},findListedPrice:function(){if(!this.showListedPrice)return null;var e=this.model.get("pricesByUnit"),t=this.model.get("listedPrice");return null===t&&(t={},a.each(e,function(e,i){t[i]=a.last(e)}),this.model.set("listedPrice",t)),t}});return l}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/list-item-product-prices-view.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/orofrontend/js/app/elements-helper.js"),o=i("./bundles/oroui/js/layout.js"),s=i("./bundles/oroui/js/app/models/base/model.js"),r=i("./bundles/oropricing/js/app/prices-helper.js"),a=i("../node_modules/bootstrap/js/dist/popover.js"),l=i("./bundles/oroui/js/extend/underscore.js"),u=i("./bundles/orolocale/js/formatter/number.js"),c=i("./bundles/oropricing/js/app/views/list-item-product-prices-subview.js"),d=t.extend(l.extend({},n,{pricesHintContent:i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/list-item-prices-tier-table.html"),elements:{prices:'[data-name="prices"]',pricesHint:'[data-name="prices-hint-trigger"]'},defaultOptions:{showValuePrice:!0,showListedPrice:!0,showHint:!0,doUpdateQtyForUnit:!0,changeUnitLabel:!1},modelAttr:{prices:{},qtyCheckedForUnit:{}},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){d.__super__.initialize.call(this,e),this.deferredInitializeCheck(e,["productModel"])},deferredInitialize:function(e){e=l.defaults(e,this.defaultOptions),this.initModel(e),this.model&&(this.showHint=e.showHint,this.showListedPrice=e.showListedPrice,this.showValuePrice=e.showValuePrice,this.doUpdateQtyForUnit=e.doUpdateQtyForUnit,this.changeUnitLabel=e.changeUnitLabel,this.initializeElements(e),this.render())},dispose:function(){this.disposeElements(),this.model&&this.model.off(null,null,this),d.__super__.dispose.call(this)},render:function(){return this.doUpdateQtyForUnit&&(this.updateQtyForUnit(),this.model.off("change:unit",this.updateQtyForUnit,this),this.model.on("change:unit",this.updateQtyForUnit,this)),(this.showListedPrice||this.showValuePrice)&&this.renderPriceBlock(),this.showHint&&this.renderHint(),this},updateQtyForUnit:function(){var e=this.model.get("unit"),t=this.model.get("qtyCheckedForUnit");if(!l.isEmpty(t[e]))return!1;var i=this.model.get("pricesByUnit");if(l.isEmpty(i)||l.isEmpty(i[e]))return!1;t[e]=!0;var n=l.last(i[e]);return this.model.get("quantity")<n.quantity&&this.model.set("quantity",n.quantity),!0},renderHint:function(){var e=this.getElement("pricesHint"),t=this.getPreparedPriceForHint();0!==e.length&&(e.data(a.DATA_KEY)||o.initPopoverForElements(e,{container:"body",placement:"bottom",trigger:"manual",close:!1,class:"prices-hint-content",forceToShowTitle:!0},!0),e.data(a.DATA_KEY).updateContent(this.pricesHintContent({prices:t,formatter:u})))},getPreparedPriceForHint:function(){return r.sortUnitPricesByLowQuantity(this.model.get("pricesByUnit"))},renderPriceBlock:function(e){0!==this.getElement("prices").length?!1===l.isEmpty(this.model.get("prices"))?this.subview("prices",new c({autoRender:!0,el:this.getElement("prices"),model:this.model,showListedPrice:this.showListedPrice,showValuePrice:this.showValuePrice,changeUnitLabel:this.changeUnitLabel})):this.getElement("prices").html(l.__("oro.pricing.product_prices.empty_prices")):e&&console.error("Price block expected but doesn't exist.")},initModel:function(e){this.modelAttr=l.extend({},this.modelAttr,e.modelAttr||{}),e.productModel&&(this.model=e.productModel,this._onPricesChanged()),this.model||(this.model=new s),this.model.off("change:prices",this._onPricesChanged,this),this.model.on("change:prices",this._onPricesChanged,this),l.each(this.modelAttr,function(e,t){this.model.has(t)&&l.isEmpty(e)||this.model.set(t,e)},this)},_onPricesChanged:function(){this.model.set("pricesByUnit",r.preparePrices(this.model.get("prices")))}}));return d}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/product-prices-editable-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.iterator.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),i("../node_modules/core-js/modules/web.url.to-json.js"),void 0===(n=function(e){"use strict";var t=i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-tier-button.html"),n=i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-tier-table.html"),o=i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oropricing/templates/product/prices-price-overridden.html"),s=i("./bundles/oropricing/js/app/views/base-product-prices-view.js"),r=i("./bundles/orolocale/js/formatter/number.js"),a=i("../node_modules/bootstrap/js/dist/popover.js"),l=i("./bundles/oroui/js/layout.js"),u=i("./bundles/oroui/js/extend/jquery.js"),c=i("./bundles/oroui/js/extend/underscore.js"),d=i("./bundles/oroui/js/mediator.js"),p=i("./bundles/oropricing/js/app/prices-helper.js"),h=s.extend({elements:c.extend({},s.prototype.elements,{pricesHint:null,pricesHintContent:null,priceOverridden:null,priceValue:'[data-name="field__value"]'}),modelAttr:{found_price:null},elementsEvents:c.extend({},s.prototype.elementsEvents,{"priceValue onPriceSetManually":["change","onPriceSetManually"]}),modelElements:c.extend({},s.prototype.modelElements,{price:"priceValue"}),options:{matchedPriceEnabled:!0,precision:4,editable:!0,ariaControlsId:null},templates:{priceOverridden:o,pricesHint:t,pricesHintContent:n},events:function(){var e={},t=this.eventNamespace(),i=function(e,i){var n=u(i.target).data(a.DATA_KEY);u(n.getTipElement()).off(t).on("click"+t,"a",function(t){t.preventDefault(),n.hide(),e(this)})};return e[a.Event.SHOWN+" .product-price-overridden"]=c.wrap(this.useFoundPrice.bind(this),i),e[a.Event.SHOWN+" .product-tier-prices"]=c.wrap(this.setPriceFromHint.bind(this),i),e[a.Event.HIDDEN+" [data-toggle=popover]"]=function(e){var i=u(e.target).data(a.DATA_KEY).getTipElement();u(i).off(t)},e},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=u.extend(!0,{},this.options,c.pick(e,c.keys(this.options))),this.templates=u.extend(!0,{},this.templates,e.templates||{}),h.__super__.initialize.call(this,e)},deferredInitialize:function(e){h.__super__.deferredInitialize.call(this,e)},dispose:function(e){delete this.templates,h.__super__.dispose.call(this)},findPrice:function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];var n=h.__super__.findPrice.apply(this,t);return this.model.set("found_price",n),this.getElement("priceValue").data("found_price",n),n},setFoundPrice:function(){this.findPrice(),this.options.matchedPriceEnabled&&this.getElement("priceValue").hasClass("matched-price")&&this.setPriceValue(this.findPriceValue()),this.updateUI()},setPriceValue:function(e){this.model.set("price",this.calcTotalPrice(e)),this.getElement("priceValue").trigger("blur")},updateUI:function(){this.renderPriceOverridden(),this.renderHint()},initPriceOverridden:function(){if((this.priceOverriddenInitialized=!0,this.options.matchedPriceEnabled&&this.options.editable)&&(this.getElement("priceValue").val()||this.getElement("priceValue").data("match-price-on-null"))){var e=this.createElementByTemplate("priceOverridden");l.initPopover(e),e.insertAfter(this.getElement("priceValue")),c.isEmpty(this.getElement("priceValue").val())&&this.options.matchedPriceEnabled&&this.unlockPrice()}},initHint:function(){this.hintInitialized=!0,"function"!=typeof this.templates.pricesHintContent&&(this.templates.pricesHintContent=c.template(this.getElement("pricesHintContent").html()));var e=this.createElementByTemplate("pricesHint"),t=this.model.get("sku"),i=function(t){e.attr("aria-label",c.__("oro.pricing.view_all_prices_extended",{product_attrs:t}))};t&&i(t),this.model.on("change:sku",function(e,t){return i(t)}),this.getElement("priceValue").after(e)},getHintContent:function(){return c.isEmpty(this.prices)?"":this.templates.pricesHintContent({model:this.model.toJSON(),prices:p.sortUnitPricesByLowQuantity(this.prices),matchedPrice:this.findPrice(),clickable:this.options.editable,formatter:r,ariaControlsId:this.options.ariaControlsId})},renderHint:function(){return this.hintInitialized||this.initHint(),h.__super__.renderHint.call(this)},onPriceSetManually:function(e,t){t.manually&&this.options.matchedPriceEnabled&&this.lockPrice()},setPriceFromHint:function(e){this.lockPrice();var t=u(e);this.model.set("unit",t.data("unit")),this.setPriceValue(t.data("price"))},renderPriceOverridden:function(){if(this.options.matchedPriceEnabled){this.priceOverriddenInitialized||this.initPriceOverridden();var e=r.unformatStrict(this.model.get("price")),t=this.findPriceValue();null!==t&&this.calcTotalPrice(t)!==this.calcTotalPrice(e)?(this.getElement("priceOverridden").show(),this.getElement("priceValue").addClass("overridden-price")):(this.getElement("priceOverridden").hide(),this.getElement("priceValue").removeClass("overridden-price"))}},calcTotalPrice:function(e){return null===e?e:r.formatMonetary(e)},useFoundPrice:function(){this.options.matchedPriceEnabled&&(this.setPriceValue(this.findPriceValue()),this.unlockPrice())},lockPrice:function(){this.getElement("priceValue").removeClass("matched-price"),d.trigger("pricing:product-price:lock",this.getElement("priceValue"))},unlockPrice:function(){this.getElement("priceValue").addClass("matched-price"),d.trigger("pricing:product-price:unlock",this.getElement("priceValue"))}});return h}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/product-total-price-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.regexp.to-string.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/oropricing/js/app/prices-helper.js"),o=i("./bundles/orolocale/js/formatter/number.js"),s=i("./bundles/orofrontend/js/app/elements-helper.js"),r=i("./bundles/oroshoppinglist/js/shoppinglist-collection-service.js"),a=i("./bundles/oroui/js/extend/underscore.js"),l=t.extend(a.extend({},s,{autoRender:!1,elements:{totalQty:'[data-role="total-quantity"]',totalPrice:'[data-role="total-price"]'},prices:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){l.__super__.initialize.call(this,e),this.initModel(e),this.setPrices(),this.initializeElements(e),r.shoppingListCollection.done(a.bind(function(e){this.shoppingListCollection=e,this.listenTo(e,"change",this.render)},this))},initModel:function(e){e.productModel&&(this.model=e.productModel)},render:function(){var e=this._calcTotals();this.$el.toggleClass("hide",0===e.quantity),this.getElement("totalQty").text(e.quantity),this.getElement("totalPrice").text(o.formatCurrency(e.price))},setPrices:function(){this.prices={};var e=this.model.get("prices");a.each(e,function(e,t){this.prices[t]=n.preparePrices(e)},this)},_getCurrentShoppingList:function(){return this.shoppingListCollection.find({is_current:!0})},_getCurrentLineItems:function(){var e=this._getCurrentShoppingList();return e&&a.find(this.model.get("shopping_lists"),{id:e.get("id")})||null},_calcTotals:function(){var e={price:0,quantity:0},t=this._getCurrentLineItems();return a.isNull(t)?e:e=a.reduce(t.line_items,function(e,t){var i=t.quantity>0?t.quantity.toString():"";return e.price+=n.calcTotalPrice(this.prices[t.productId],t.unit,i),e.quantity+=t.quantity,e},e,this)}}));return l}.call(t,i,t,e))||(e.exports=n)},"./bundles/oropricing/js/app/views/quick-add-row-price-view.js":function(e,t,i){"use strict";i.r(t);var n=i("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),o=i.n(n),s=(i("../node_modules/core-js/modules/es.object.assign.js"),i("../node_modules/core-js/modules/es.object.keys.js"),i("./bundles/oroui/js/app/views/base/view.js")),r=i.n(s),a=i("./bundles/orolocale/js/formatter/number.js"),l=i.n(a),u=i("./bundles/orotranslation/js/translator.js"),c=i.n(u),d=i("./bundles/oroui/js/extend/jquery.js"),p=i.n(d),h=i("./bundles/oroui/js/extend/underscore.js"),_=i.n(h),m=i("./bundles/oropricing/js/app/prices-helper.js"),f=i.n(m),g=i("./bundles/oroui/js/layout.js"),b=i.n(g),j=i("../node_modules/bootstrap/js/dist/popover.js"),v=i.n(j),y=i("./bundles/orolocale/js/numeral-l10n.js"),w=i.n(y),x=["prices_index"],P=r.a.extend({defaults:{defaultQuantity:"",subtotalNotAvailable:c()("oro.pricing.price.not_available")},priceNotFoundTemplate:'<div class="text-center"><%- _.__("oro.pricing.product_prices.price_not_found") %></div>',elem:{subtotal:'[data-name="field__product-subtotal"]',pricesHintContentRendered:'[data-class="prices-hint-content"]'},listen:{"change:prices model":"indexPrices","change:prices_index model":"updatePrice","change:quantity model":"updatePrice","change:unit model":"updatePrice","change:subtotal model":"updateUI"},events:{'click [data-role="price-hint-trigger"]':"updateHintContent",'focus [data-role="price-hint-trigger"]':"updateHintContent"},constructor:function e(t){e.__super__.constructor.call(this,t),this.model.get("prices")&&this.indexPrices()},initialize:function(e){this.options=Object.assign({},this.defaults,_.a.pick(e,Object.keys(this.defaults))),this.elem=Object.assign({},this.elem,e.elements||{}),Object.assign(this,_.a.pick(e,["pricesHintTemplateSelector","pricesHintTemplateContentSelector"])),P.__super__.initialize.call(this,e)},dispose:function(){this.disposed||(delete this.$pricesHint,P.__super__.dispose.call(this))},indexPrices:function(){var e=this.model.get("prices")||{},t=f.a.indexPrices(e);this.prices=f.a.preparePrices(t),this.model.set("prices_index",t)},updatePrice:function(){var e=this.model.get("quantity"),t=this.model.get("unit"),i=f.a.findPrice(this.prices,t,e);this.model.set("price",i),this.checkMinQtyForUnit(),this.model.set("subtotal",this.calcSubtotal())},checkMinQtyForUnit:function(){var e=this.model.get("unit");if(!this.model.get("quantity_changed_manually")&&e&&this.prices&&this.prices[e]){var t=this.model.get("quantity"),i=this.prices[e],n=_.a.findLastIndex(i,function(e){return e.quantity});-1!==n&&t<i[n].quantity&&this.model.set("quantity",i[n].quantity)}},calcSubtotal:function(){var e=this.model.get("price"),t=this.model.get("quantity");return e&&t?l.a.formatCurrency(w()(e.price).multiply(t).value(),e.currency):this.model.get("unit")?this.options.subtotalNotAvailable:null},updateUI:function(){this.$(this.elem.subtotal).val(this.model.get("subtotal")),this.renderHint();var e=this.$(this.elem.pricesHintContentRendered);this.model.get("subtotal")?e.show():e.hide()},renderHint:function(){if(void 0===this.$pricesHint){var e=this.getTemplateFunction("pricesHintTemplate");this.$pricesHint=this.$(this.elem.subtotal).after(e).next()}},updateHintContent:function(e){if(this.$pricesHint.length){var t=this.model.getAttributes(),i=t.prices_index,n=o()(t,x);n.prices=i,this.$pricesHint.data(v.a.DATA_KEY)||(b.a.initPopoverForElements(this.$pricesHint,{container:"body",forceToShowTitle:!0},!0),p()(e.target).trigger(e));var s=_.a.isEmpty(n.prices)?"priceNotFoundTemplate":"pricesHintTemplateContent",r=this.getTemplateFunction(s);this.$pricesHint.data(v.a.DATA_KEY).updateContent(r({model:n,prices:this.prices,matchedPrice:this.model.get("price"),clickable:!1,formatter:l.a}))}}});t.default=P},"./bundles/oroproduct/js/app/components/breadcrumbs-navigation-block.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.function.name.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/web.dom-collections.for-each.js"),i("../node_modules/core-js/modules/es.array.join.js"),i("../node_modules/core-js/modules/es.regexp.exec.js"),i("../node_modules/core-js/modules/es.string.replace.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/oroui/js/extend/jquery.js"),o=i("./bundles/orotranslation/js/translator.js"),s=t.extend({$element:null,constructor:function e(t){e.__super__.constructor.call(this,t)},listen:{"datagrid_filters:update mediator":"onFiltersUpdate"},initialize:function(e){this.$element=e._sourceElement,s.__super__.initialize.call(this,e)},onFiltersUpdate:function(e){this.updateFiltersInfo(e),this.updateSortingInfo(e),this.updatePaginationInfo(e)},updateFiltersInfo:function(e){var t=[],i=function(i,n){if(n.name===i&&n.visible){var o=e.filterManager.filters[n.name].getState().hint;t.push({hint:o,label:n.label})}};for(var o in e.collection.state.filters)e.collection.state.filters.hasOwnProperty(o)&&e.metadata.filters.forEach(i.bind(null,o));if(0!==t.length){var s=[];t.forEach(function(e){s.push(function(e){return e.label+" "+e.hint}(e))});var r="["+s.join(", ")+"]";n(".filters-info",this.$element).text(r)}else n(".filters-info",this.$element).html("")},updateSortingInfo:function(e){var t=o("oro.product.grid.navigation_bar.sorting.label"),i=e.collection.state.sorters,s="",r="";for(var a in i)if(i.hasOwnProperty(a)){s=a,r=o("oro.product.grid.navigation_bar.sorting."+(i[a]>0?"desc":"asc"));break}t=t.replace("%column%",s).replace("%direction%",r),n(".sorting-info",this.$element).html(t)},updatePaginationInfo:function(e){var t=o("oro.product.grid.navigation_bar.pagination.label"),i=e.collection.state,s=(i.currentPage-1)*i.pageSize+1,r=i.totalRecords<i.pageSize?i.totalRecords:i.currentPage*i.pageSize;t=t.replace("%start%",s).replace("%end%",r).replace("%total%",i.totalRecords),n(".pagination-info",this.$element).html(t)}});return s}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/catalog-switch-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.regexp.exec.js"),i("../node_modules/core-js/modules/es.string.search.js"),i("../node_modules/core-js/modules/es.string.split.js"),i("../node_modules/core-js/modules/es.array.join.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/orodatagrid/js/url-helper.js"),o=i("./bundles/oroui/js/extend/jquery.js"),s=i("./bundles/oroui/js/extend/underscore.js"),r=i("./bundles/oroui/js/tools.js"),a=i("./bundles/oroui/js/mediator.js"),l=t.extend(s.extend({},n,{parameterName:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){l.__super__.initialize.call(this,e),this.parameterName=e.parameterName,e._sourceElement.on("click","[data-catalog-view-trigger]",s.bind(this._onSwitch,this))},_onSwitch:function(e){if(""!==location.search){e.preventDefault();var t=o(e.currentTarget).data("catalog-view-trigger"),i=this.updateUrlParameter(location.href,this.parameterName,t);a.execute("redirectTo",{url:i},{redirect:!0})}},updateUrlParameter:function(e,t,i){var n=e.split("?"),o={};return n.length>1&&(o=r.unpackFromQueryString(n[1])),o[t]||(o[t]={}),s.extend(o[t],i),n[1]=r.packToQueryString(o),n.join("?")}}));return l}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/fullscreen-attribute-group-tab-content-component.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroentityconfig/js/components/attribute-group-tab-content-component.js"),n=i("./bundles/orofrontend/blank/js/app/views/fullscreen-popup-view.js"),o=i("./bundles/oroui/js/viewport-manager.js"),s=t.extend({constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){return this.viewport=e.viewport||{},s.__super__.initialize.call(this,e)},onGroupChange:function(e,t){s.__super__.onGroupChange.call(this,e),!t&&this.id===e.get("id")&&o.isApplicable(this.viewport)&&(e.get("active")?this.fullscreenView||(this.fullscreenView=new n({disposeOnClose:!0,contentElement:this.el}),this.fullscreenView.on("close",function(){this.fullscreenView.dispose(),delete this.fullscreenView},this),this.fullscreenView.show()):this.fullscreenView&&(this.fullscreenView.dispose(),delete this.fullscreenView))}});return s}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/product-unit-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/oroui/js/app/models/base/model.js"),o=i("./bundles/oroproduct/js/app/units-util.js"),s=i("./bundles/oroui/js/app/views/loading-mask-view.js"),r=i("./bundles/fosjsrouting/js/router.js"),a=i("./bundles/oroui/js/extend/underscore.js"),l=i("./bundles/oroui/js/extend/jquery.js"),u=i("./bundles/orotranslation/js/translator.js"),c=t.extend({options:{productSelector:'.product-product [data-name="field__product"]',quantitySelector:".product-quantity input",unitSelector:".product-unit select",routeName:"oro_product_unit_product_units",routingParams:{},errorMessage:"Sorry, an unexpected error has occurred.",loadingMaskEnabled:!0,dropQuantityOnLoad:!0,defaultValues:null},loadingMaskView:null,productSelector:null,quantitySelector:null,unitSelector:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=a.defaults(e||{},this.options),this.model||(this.model=new n),this.initializeLoadingMask(e),this.options._sourceElement.on("change",this.options.productSelector,a.bind(this.onProductChange,this)),this.quantitySelector=this.options._sourceElement.find(this.options.quantitySelector),this.unitSelector=this.options._sourceElement.find(this.options.unitSelector),this.productSelector=this.options._sourceElement.find(this.options.productSelector),this.productSelector.val()||this._dropValues()},initializeLoadingMask:function(e){e.loadingMaskEnabled&&(this.loadingMaskView=new s({container:this.options._sourceElement}))},onProductChange:function(e){this.unitSelector.trigger("value:changing");var t=e.target.value;if(t){var i=l.extend({},this.options.routingParams,{id:t});l.ajax({url:r.generate(this.options.routeName,i),beforeSend:this._beforeSend.bind(this),success:this._success.bind(this),complete:this._complete.bind(this),errorHandlerMessage:u(this.options.errorMessage),error:this._dropValues.bind(this)})}else this._dropValues()},_beforeSend:function(){this.loadingMaskView&&this.loadingMaskView.show()},_dropValues:function(){this.options.dropQuantityOnLoad&&this.handleQuantityState(!0),this.handleUnitsState(this.options.defaultValues)},_success:function(e){this.handleQuantityState(!1),this.handleUnitsState(e.units)},_complete:function(){this.loadingMaskView&&this.loadingMaskView.hide()},handleQuantityState:function(e){this.quantitySelector.prop("disabled",e),this.options.dropQuantityOnLoad&&this.quantitySelector.val(null)},handleUnitsState:function(e){this.model.set("product_units",e),o.updateSelect(this.model,this.unitSelector),this.unitSelector.trigger("value:changed").trigger("change")},dispose:function(){this.disposed||(this.options._sourceElement.off(),c.__super__.dispose.call(this))}});return c}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/product-unit-select-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.iterator.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/oroproduct/js/app/units-util.js"),o=i("./bundles/oroui/js/extend/underscore.js");return t.extend({options:{unitLabel:"oro.product.product_unit.%s.label.full",singleUnitMode:!1,singleUnitModeCodeVisible:!1,configDefaultUnit:null},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){o.extend(this.options,e||{}),this.initSelect()},initSelect:function(){var e=this.options.productModel||null;if(e){var t=this.options._sourceElement.find("select");n.updateSelect(e,t);var i=o.keys(e.get("product_units"));this.isProductApplySingleUnitMode(i)&&(this.options.singleUnitModeCodeVisible&&t.parent().append('<span class="unit-label">'+i[0]+"</span>"),t.inputWidget("dispose"),t.addClass("no-input-widget").hide())}},isProductApplySingleUnitMode:function(e){return!(!this.options.singleUnitMode||1!==e.length)&&e[0]===this.options.configDefaultUnit}})}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/product-variant-field-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.object.keys.js"),i("../node_modules/core-js/modules/es.symbol.js"),i("../node_modules/core-js/modules/es.object.get-own-property-descriptor.js"),i("../node_modules/core-js/modules/es.object.get-own-property-descriptors.js");var o=i("../node_modules/@babel/runtime/helpers/defineProperty.js"),s=i("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),r=["attributes"];function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,n)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach(function(t){o(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.concat.js"),i("../node_modules/core-js/modules/es.array.filter.js"),i("../node_modules/core-js/modules/web.dom-collections.for-each.js"),i("../node_modules/core-js/modules/es.object.values.js"),i("../node_modules/core-js/modules/es.array.slice.js"),i("../node_modules/core-js/modules/es.regexp.exec.js"),i("../node_modules/core-js/modules/es.string.split.js"),i("../node_modules/core-js/modules/es.string.replace.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/oroui/js/extend/jquery.js"),o=i("./bundles/oroui/js/app/components/view-component.js"),a=i("./bundles/oroui/js/error.js"),u=i("./bundles/oroui/js/tools.js"),c=i("./bundles/oroform/js/extend/validate.js").validator,d=o.extend({options:{simpleProductVariants:{}},$el:null,filteredOptions:null,_filtered:null,_hierarchy:null,state:null,simpleProductVariants:{},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.filteredOptions=[],this._hierarchy=[],this.state={},this.options=t.defaults(e||{},u.deepClone(this.options)),d.__super__.initialize.call(this,e),this.$el=this.options._sourceElement,this._prepareProductVariants(),this.deferredInit.done(t.bind(this._initVariantInstances,this))},setState:function(e,i){return t.isUndefined(i)?a.showErrorInConsole("The value should be defined"):(this.state[e]=i,this.state)},getState:function(e){return e?this.state[e]:this.state},updateFields:function(){this.$el.find("select").each(t.bind(function(e,t){-1===this._filtered.indexOf(n(t).val())&&(n(t).val(""),this.setState(this._extractName(n(t).data("name")),null)),n(t).trigger("change.select2")},this))},dispose:function(){this.disposed||(this.$el.off(),delete this._filtered,delete this._hierarchy,delete this.state,delete this.filteredOptions,d.__super__.dispose.call(this))},_initVariantInstances:function(){var e=t.bind(this._onVariantFieldChange,this,this.simpleProductVariants);this.view.el.reset(),this.$el.find("select").length&&this.$el.find("select").each(t.bind(function(e,i){var o=n(i),s=this._extractName(o.data("name"));this.filteredOptions=this.filteredOptions.concat(o.find("option").get().filter(t.bind(function(e){return e.value=""!==e.value?s+"_"+e.value:"",!e.disabled&&""!==e.value},this))),this._appendToHierarchy(s),this.setState(s,o.val())},this)),this._resolveVariantFieldsChain(this.simpleProductVariants),this.$el.on("change","select",e)},_prepareProductVariants:function(){this.simpleProductVariants=t.mapObject(this.options.simpleProductVariants,function(e){return t.reduce(e.attributes,function(e,t,i){return e[this._extractName(i)]=this._extractName(i)+"_"+this._normalizeBool(t),e},{},this)},this)},_appendToHierarchy:function(e){return t.isString(e)?-1!==this._hierarchy.indexOf(e)?a.showErrorInConsole("Item: "+e+" is already exist!"):(this._hierarchy.push(e),this._hierarchy):a.showErrorInConsole(e+" should be string")},_onVariantFieldChange:function(e,t){var i=n(t.target);this.setState(this._extractName(i.data("name")),i.val()),this._resolveVariantFieldsChain(e)},_resolveVariantFieldsChain:function(e){this._filtered=this._resolveHierarchy(e),this.filteredOptions.forEach(t.bind(function(e){e.disabled=-1===t.indexOf(this._filtered,e.value)},this)),this._updateProduct(),this.updateFields()},_resolveHierarchy:function(e){var i=[];return this._hierarchy.forEach(t.bind(function(n,o){var s=this._hierarchy[o-1];e=t.isUndefined(s)?e:t.where(e,this._prepareFoundKeyValue(s)),i=i.concat(t.uniq(t.pluck(e,n)))},this)),i},_prepareFoundKeyValue:function(e){var t={};return t[e]=this.getState(e),t},_updateProduct:function(){var e=this,i=this.simpleProductVariants,n=!Object.values(this.getState()).some(function(e){return!e});if(this.view.$el.data("validator")&&c.preloadMethods().then(function(){return e.view.$el.valid()}),n){for(var o in i)if(i.hasOwnProperty(o)&&t.isEqual(this.getState(),i[o])){var a=this.options.simpleProductVariants[o],u=(a.attributes,s(a,r));this.view.updateProductModel(l({id:o},u));break}}else this.view.updateProductModel({id:0},!0)},_extractName:function(e){return e=(e=e.toLowerCase().split("__").slice(-1)[0]).replace(/[-_]/g,"")},_normalizeBool:function(e){return t.isBoolean(e)?+e:e}});return d}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/quick-add-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/oroui/js/extend/jquery.js"),o=i("./bundles/oroui/js/mediator.js"),s=i("./bundles/oroui/js/app/components/base/component.js").extend({options:{componentSelector:'[name$="[component]"]',additionalSelector:'[name$="[additional]"]',componentButtonSelector:".component-button",componentPrefix:"quick-add"},$form:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=t.defaults(e||{},this.options),this.$form=this.options._sourceElement,this.$form.on("click",this.options.componentButtonSelector,t.bind(this.fillComponentData,this)),o.on(this.options.componentPrefix+":submit",this.submit,this)},fillComponentData:function(e){var t=n(e.target);this.submit(t.data("component-name"),t.data("component-additional"))},submit:function(e,t){this.$form.find(this.options.componentSelector).val(e),this.$form.find(this.options.additionalSelector).val(t),this.$form.submit()},dispose:function(){this.disposed||(o.off(this.options.componentPrefix+":submit",this.submit,this),s.__super__.dispose.call(this))}});return s}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/quick-add-form-button-component.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/orotranslation/js/translator.js"),o=i("./bundles/oroui/js/extend/jquery.js"),s=i("./bundles/oroui/js/app/components/base/component.js"),r=i("./bundles/oroui/js/modal.js"),a=s.extend({options:{},$button:null,$form:null,messages:null,defaultMessages:{confirm_title:"oro.product.dialog.quick_add.confirm.title",confirm_content:"oro.product.dialog.quick_add.confirm.content",confirm_ok:"oro.product.dialog.quick_add.confirm.continue",confirm_cancel:"oro.product.dialog.quick_add.confirm.cancel"},confirmation:!1,confirmModalConstructor:r,confirmMessage:null,constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=t.defaults(e||{},this.options),this.$button=this.options._sourceElement,this.$form=this.$button.closest("form"),this.confirmMessage=n(this.defaultMessages.confirm_content),e.confirmation&&(e.shopping_list_limit&&(this.confirmMessage=n(this.defaultMessages.confirm_content,{count:e.shopping_list_limit},e.shopping_list_limit)),this.confirmation=o.extend(!0,{},this.confirmation,e.confirmation)),this.messages=t.extend({},this.defaultMessages,this.messages),this.$button.on("click",t.bind(this.submit,this))},dispose:function(){this.disposed||(delete this.messages,a.__super__.dispose.call(this))},submit:function(e){e.preventDefault(),e.stopPropagation(),this.formHasErrors()||(t.each(this.options,t.bind(function(e,t){"_sourceElement"!==t&&this.$form.find(e).val(this.$button.data(t))},this)),this.confirmation?this.getConfirmDialog(t.bind(this.executeConfiguredAction,this)).open():this.executeConfiguredAction())},formHasErrors:function(){return!this.$form.validate().valid()||this.$form.find(".product-autocomplete-error .validation-failed:visible").length},getConfirmDialog:function(e){var t=new this.confirmModalConstructor({title:n(this.messages.confirm_title),content:this.confirmMessage,okText:n(this.messages.confirm_ok),cancelText:n(this.messages.confirm_cancel)});return t.on("ok",e),t},executeConfiguredAction:function(){this.$form.submit()}});return a}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/quick-add-import-validation-component.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/orotranslation/js/translator.js"),o=i("./bundles/oroui/js/extend/jquery.js"),s=i("./bundles/oroui/js/widget/widget-manager.js"),r=i("./bundles/oroui/js/app/components/base/component.js"),a=i("./bundles/oroui/js/mediator.js");return r.extend({options:{_wid:"",validItemsCount:0,itemsTableRows:"table.quick_add_validation_items tbody tr"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=t.defaults(e||{},this.options),this.listenTo(a,{"widget:contentLoad":this.onWidgetRender})},submitAction:function(e){var t=o(this.options.itemsTableRows,e.el),i=[];t.each(function(e,t){i.push(o(t).data("rowItem"))}),a.trigger("quick-add-import-form:submit",i),s.getWidgetInstance(this.options._wid,this.closeWidget)},closeWidget:function(e){e.remove()},onWidgetRender:function(){var e=t.template(this.options.titleTemplate),i="",r=this;s.getWidgetInstance(this.options._wid,function(s){var a=s.getWidget().get(0),l=o.data(a,"ui-dialog");s.off("adoptedFormSubmitClick").on("adoptedFormSubmitClick",t.bind(r.submitAction,r,s)),l._title=function(e){this.options.title?e.html(this.options.title):e.html("&#160;")},void 0!==r.options.validItemsCount&&(i=n("oro.product.frontend.quick_add.import_validation.subtitle",{count:r.options.validItemsCount},r.options.validItemsCount)),s.setTitle(e({title:n("oro.product.frontend.quick_add.import_validation.title"),subtitle:i}))})}})}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/components/quick-add-row-extension-view-component.js":function(e,t,i){"use strict";i.r(t);var n=i("../node_modules/@babel/runtime/helpers/objectWithoutProperties.js"),o=i.n(n),s=i("./bundles/oroui/js/app/components/view-component.js"),r=["relatedSiblingComponents","productsCollection"],a=i.n(s).a.extend({relatedSiblingComponents:{quickAddRowComponent:"quick-add-row-component"},constructor:function e(t){e.__super__.constructor.call(this,t)},_initializeView:function(e,t){var i=e.relatedSiblingComponents,n=(e.productsCollection,o()(e,r));this.disposed||i.quickAddRowComponent.disposed?this._resolveDeferredInit():(n.model=i.quickAddRowComponent.view.model,a.__super__._initializeView.call(this,n,t))}});t.default=a},"./bundles/oroproduct/js/app/components/redirect-component.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/components/base/component.js"),n=i("./bundles/oroui/js/mediator.js");return t.extend({options:{targetUrl:null},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){var t=e.targetUrl||null;this.redirectTo(t)},redirectTo:function(e){e&&n.execute("redirectTo",{url:e},{redirect:!0})}})}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/views/base-product-variants-view.js":function(e,t,i){var n;i("../node_modules/core-js/modules/es.array.iterator.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/orofrontend/js/app/elements-helper.js"),o=i("./bundles/oroui/js/app/views/loading-mask-view.js"),s=i("./bundles/oroui/js/extend/jquery.js"),r=i("./bundles/oroui/js/extend/underscore.js"),a=t.extend(r.extend({},n,{options:{showLoading:!0},elements:{variantForm:'[data-name="form__oro-product-product-variant-frontend-variant-field"]',variantFields:["variantForm",":input[data-name]"]},elementsEvents:{},events:{submit:"onSubmit"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.options=s.extend(!0,{},this.options,r.pick(e,r.keys(this.options))),a.__super__.initialize.call(this,e),this.initModel(e),this.initializeElements(e)},initModel:function(e){e.productModel&&(this.model=e.productModel)},onSubmit:function(e){e.preventDefault()},updateProductModel:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{id:0},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.isObject(e)&&(e.id=e.id?parseInt(e.id,10):0,this.model.set(e,{silent:t}))},showLoading:function(){if(this.options.showLoading){var e=this.$el.closest('[data-role="layout-subtree-loading-container"]');e.length||(e=this.$el),this.subview("loadingMask",new o({container:e})),this.subview("loadingMask").show()}},hideLoading:function(){this.options.showLoading&&this.removeSubview("loadingMask")},dispose:function(){this.disposeElements(),a.__super__.dispose.call(this)}}));return a}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/views/product-quantity-editable-view.js":function(e,t,i){var n,o=i("../node_modules/@babel/runtime/helpers/toConsumableArray.js");i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.iterator.js"),i("../node_modules/core-js/modules/web.dom-collections.iterator.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/app/views/base/view.js"),n=i("./bundles/oroui/js/tools/api-accessor.js"),s=i("./bundles/oroui/js/mediator.js"),r=i("./bundles/oroui/js/tools.js"),a=i("./bundles/oroui/js/extend/jquery.js"),l=i("./bundles/oroui/js/extend/underscore.js"),u=i("./bundles/orotranslation/js/translator.js"),c=i("./bundles/oroproduct/js/app/quantity-helper.js"),d=t.extend({options:{quantityFieldName:"quantity",unitFieldName:"unit",dataKey:null,enable:!1,save_api_accessor:{http_method:"PUT"},messages:{success:u("oro.form.inlineEditing.successMessage"),processingMessage:u("oro.form.inlineEditing.saving_progress"),preventWindowUnload:u("oro.form.inlineEditing.inline_edits")},elements:{saveButton:"",quantity:'[name$="[quantity]"]',unit:'[name$="[unit]"]'},validation:{showErrorsHandler:null,rules:{quantity:{NotBlank:{message:"oro.product.validation.quantity.required"},OpenRange:{min:0,minMessage:"oro.product.validation.quantity.greaterThanZero"}},unit:{NotBlank:{message:"oro.product.validation.unit.required"}}}}},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){(e=a.extend(!0,{},this.options,e)).enable&&(this._isSaving=!1,this.messages=e.messages,this.dataKey=e.dataKey,this.quantityFieldName=e.quantityFieldName,this.unitFieldName=e.unitFieldName,this.triggerData=e.triggerData||null,this.initElements(e),this.saveModelState(),this.saveApiAccessor=new n(e.save_api_accessor))},initElements:function(e){this.elements={},l.each(e.elements,function(e,t){this.elements[t]=e?this.$el.find(e):null},this),this.elements.unit.prop("disabled",!1),this.elements.unit.find(":selected").is(":disabled")||this.enableQuantity(),this.initValidator(e),this.deferredInit?this.deferredInit.done(l.bind(this.initListeners,this)):this.initListeners(),this._bindEvents(),this.disableOptions()},_bindEvents:function(){if(this.elements.unit.on("change"+this.eventNamespace(),l.bind(function(){s.trigger("unitChanged")},this)),r.isIE11()||r.isEDGE()){var e=this.elements.quantity.val();this.elements.quantity.on("focus"+this.eventNamespace(),function(t){e=t.target.value}).on("blur"+this.eventNamespace(),function(t){e!==t.target.value&&a(t.target).trigger("change")}).on("keydown"+this.eventNamespace(),function(t){13!==t.keyCode||t.ctrlKey||e===t.target.value||a(t.target).trigger("change")})}s.on("unitChanged",this.disableOptions,this)},disableOptions:function(){this.elements.unit.find("option").prop("disabled",!1),this.$el.siblings().each(l.bind(function(e,t){var i=a(t).find('[name="unit"]').val();this.elements.unit.find('[value="'+i+'"]').prop("disabled",!0)},this)),this._updateQuantityPrecision()},enableAccept:function(){this.elements.saveButton.attr("disabled",!1).inputWidget("refresh")},enableQuantity:function(){this.elements.quantity.attr("disabled",!1).inputWidget("refresh")},initValidator:function(e){var t=this.$el.find("form"),i={};i[this.elements.quantity.attr("name")]=e.validation.rules.quantity,i[this.elements.unit.attr("name")]=e.validation.rules.unit;var n={rules:i};if(e.validation.showErrorsHandler){var o=[];o.push(r.loadModuleAndReplace(e.validation,"showErrorsHandler").then(l.bind(function(){n.showErrors=e.validation.showErrorsHandler,this.updateValidation(t,n)},this))),this.deferredInit=a.when.apply(a,o)}else this.updateValidation(t,n)},updateValidation:function(e,t){if(this.validator=e.validate(),l.isObject(t)){var i=this.validator.settings;a.extend(!0,i,t)}},initListeners:function(){var e=this.onViewChange;this.elements.saveButton&&(this.elements.saveButton.on("click",l.bind(this.onViewChange,this)),e=this.enableAccept),this.$el.on("change",this.elements.quantity,l.bind(e,this)),this.$el.on("change",this.elements.unit,l.bind(e,this))},saveModelState:function(){this.oldModelState=this.getValue()},restoreSavedState:function(){var e=this.oldModelState.quantity,t=c.formatQuantity(e);this.elements.quantity.val(t).change(),this.elements.unit.val(this.oldModelState.unit).change()},onViewChange:function(e){this.isValid()&&(this.triggerData&&(this.triggerData.event=e),this.enableQuantity(),this.saveChanges())},getValue:function(){var e=this.elements.quantity.val();return{quantity:c.getQuantityNumberOrDefaultValue(e),unit:this.elements.unit.val()}},isChanged:function(){var e=this.getValue();for(var t in e)if(e.hasOwnProperty(t)&&this.oldModelState[t]!==e[t])return!0;return!1},isValid:function(){return this.validator.form()},requireSave:function(){return!this._isSaving&&this.isChanged()&&this.isValid()},saveChanges:function(){if(!this.requireSave())return!1;this._isSaving=!0;var e=this.getValue(),t=l.clone(e);t.quantity=c.formatQuantity(t.quantity);var i={};this.dataKey?i[this.dataKey]=t:i=t,this.saveApiAccessor.send(e,i,{},{processingMessage:this.messages.processingMessage,preventWindowUnload:this.messages.preventWindowUnload,errorHandlerMessage:!1}).done(l.bind(this.onSaveSuccess,this)).fail(l.bind(this.onSaveError,this)).always(l.bind(function(){this.disposed||(this._isSaving=!1)},this))},onSaveSuccess:function(e){this.saveModelState(),this.restoreSavedState();var t=l.extend({},this.triggerData||{},{value:this.getValue()});this.trigger("product:quantity-unit:update",t),s.trigger("product:quantity-unit:update",t),s.execute("showFlashMessage","success",this.messages.success)},onSaveError:function(e){var t="responseJSON"in e?e.responseJSON.code:e.status,i="responseJSON"in e?e.responseJSON.errors.errors:[];switch(this.restoreSavedState(),t){case 400:var n="responseJSON"in e?e.responseJSON.errors.children:[];for(var r in n)n.hasOwnProperty(r)&&n[r].errors&&i.push.apply(i,o(l.values(n[r].errors)));i.length||i.push(u("oro.ui.unexpected_error"));break;case 403:i.push(u("oro.ui.forbidden_error"));break;default:i.push(u("oro.ui.unexpected_error"))}l.each(i,function(e){s.execute("showFlashMessage","error",e)})},dispose:function(){this.disposed||(s.off("unitChanged",this.disableOptions,this),this.elements.unit.off("change"+this.eventNamespace()),this.elements.quantity.off(this.eventNamespace()),d.__super__.dispose.call(this))},_updateQuantityPrecision:function(){var e=this.$el.data("unit-precisions")||{},t=this.elements.unit.val();if(t in e){var i=e[t];this.elements.quantity.data("precision",i).inputWidget("refresh")}}});return d}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/views/quick-add-copy-paste-form-view.js":function(e,t,i){"use strict";i.r(t);var n=i("../node_modules/@babel/runtime/helpers/defineProperty.js"),o=i.n(n),s=i("../node_modules/@babel/runtime/helpers/slicedToArray.js"),r=i.n(s),a=i("../node_modules/@babel/runtime/helpers/asyncToGenerator.js"),l=i.n(a),u=i("../node_modules/@babel/runtime/regenerator/index.js"),c=i.n(u),d=(i("../node_modules/core-js/modules/es.regexp.exec.js"),i("../node_modules/core-js/modules/es.string.match.js"),i("../node_modules/core-js/modules/es.regexp.constructor.js"),i("../node_modules/core-js/modules/es.regexp.to-string.js"),i("../node_modules/core-js/modules/es.string.split.js"),i("../node_modules/core-js/modules/es.array.join.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/web.dom-collections.for-each.js"),i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.array.concat.js"),i("./bundles/oroui/js/extend/underscore.js")),p=i.n(d),h=i("./bundles/orotranslation/js/translator.js"),_=i.n(h),m=i("./bundles/oroui/js/mediator.js"),f=i.n(m),g=i("./bundles/oroproduct/js/app/quantity-helper.js"),b=i.n(g),j=i("./bundles/oroui/js/app/views/base/view.js"),v=i.n(j).a.extend({field:"textarea",validator:null,disabled:!1,events:{"keyup textarea":"onFieldChange","focusout textarea":"onFieldChange",submit:"onSubmit"},constructor:function e(t){this.onFieldChange=p.a.debounce(this.onFieldChange.bind(this),50),e.__super__.constructor.call(this,t)},initialize:function(e){if(!e.productsCollection)throw new Error("Option `productsCollection` is require for QuickAddCopyPasteFormComponent");this.productsCollection=e.productsCollection,v.__super__.initialize.call(this,e),this.$field=this.$(this.field),this.validator=this.$el.validate(),this.validator.element(this.$field);var t=this.$field.data("item-parse-pattern").match(/^\/(.*?)\/(g?i?m?y?)$/);if(null===t||t.length<2)throw new Error("The field must must have a data attribute with valid RegExp string");this.itemParseRegExp=new RegExp(t[1],t[2])},dispose:function(){this.disposed&&(delete this.$field,delete this.validator,v.__super__.dispose.call(this))},onFieldChange:function(){this._toggleSubmitButton(this.disabled||this.$field.hasClass("error"))},_toggleSubmitButton:function(e){var t=e||this.isEmptyField();this.$("button:submit").attr("disabled",t)},onSubmit:function(e){var t=this;return l()(c.a.mark(function i(){var n,o,s,r,a;return c.a.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e.preventDefault(),t.validator.element(t.$field)){i.next=3;break}return i.abrupt("return",!1);case 3:return t.disableForm(),n=p.a.compact(t.$field.val().split("\n")),o=t._prepareFieldItems(n),i.prev=6,i.next=9,t.productsCollection.addQuickAddRows(o,{ignoreIncorrectUnit:!1});case 9:s=i.sent,i.next=15;break;case 12:i.prev=12,i.t0=i.catch(6),f.a.execute("showFlashMessage","error",_()("oro.ui.unexpected_error"));case 15:s&&((r=s.invalid||[]).length?(a=p.a.intersection(n,p.a.flatten(p.a.pluck(r,"raw"))),t.$field.val(a.join("\n")),t._showErrorMessage()):t.$field.val("")),t.enableForm();case 17:case"end":return i.stop()}},i,null,[[6,12]])}))()},disableForm:function(){this.disabled=!0,this.$field.attr("disabled",!0),this._toggleSubmitButton(!0)},enableForm:function(){this.disabled=!1,this.$field.removeAttr("disabled"),this._toggleSubmitButton(!1)},_prepareFieldItems:function(e){var t=this,i=[];return e.forEach(function(e){var n=e.match(t.itemParseRegExp),o=r()(n,4),s=o[0],a=o[1],l=o[2],u=o[3],c=void 0===u?"":u;if(a&&l){var d={raw:[s],sku:a.toUpperCase(),quantity:b.a.getQuantityNumberOrDefaultValue(l,NaN),unit_label:c.toUpperCase()||null},p=i.find(function(e){return e.sku===d.sku&&e.unit_label===d.unit_label});p?(p.raw=p.raw.concat(d.raw),p.quantity+=d.quantity):i.push(d)}}),i},_showErrorMessage:function(){var e=this.$field.attr("name");this.isEmptyField()||this.validator.showBackendErrors(o()({},e,{errors:[_()("oro.product.frontend.quick_add.copy_paste.error")]}))},isEmptyField:function(){return 0===this.$field.val().length}});t.default=v},"./bundles/oroproduct/js/app/views/quick-add-import-form-view.js":function(e,t,i){var n,o=i("../node_modules/@babel/runtime/regenerator/index.js"),s=i("../node_modules/@babel/runtime/helpers/asyncToGenerator.js");i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.find.js"),void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/underscore.js"),n=i("./bundles/oroproduct/js/app/widget/quick-add-import-widget.js"),r=i("./bundles/oroui/js/app/views/base/view.js"),a=i("./bundles/oroui/js/mediator.js"),l=r.extend({droppableContainer:"#container",events:{"change input:file":"onFileChange",submit:"onSubmit",dragenter:"onDragenter",dragover:"onDragover",dragleave:"onDragleave",drop:"onDrop"},constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){t.extend(this,t.pick(e,"droppableContainer","productsCollection")),this.listenTo(a,{"quick-add-import-form:submit":this.onImportFormSubmit}),l.__super__.initialize.call(this,e)},delegateEvents:function(){if(l.__super__.delegateEvents.call(this),this.droppableContainer){var e=t.reduce({dragenter:"onDragenter",dragover:"onDragover",dragleave:"onDragleave",drop:"onDrop"},function(e,t,i){return e[i+this.eventNamespace()]=this[t].bind(this),e},{},this);this.$el.closest(this.droppableContainer).on(e)}return this},undelegateEvents:function(){return l.__super__.undelegateEvents.call(this),this.$el&&this.droppableContainer&&this.$el.closest(this.droppableContainer).off(this.eventNamespace()),this},onFileChange:function(){this.$el.submit()},onSubmit:function(e){if(e.isDefaultPrevented()||!this.find("input:file")[0].value)return!1;e.preventDefault(),this.getWidget().loadContentWithFormSubmit(this.$el)},onWidgetContentLoad:function(){this.find("input:file")[0].value=""},onDragenter:function(e){e.preventDefault(),e.stopPropagation(),this.highlight()},onDragover:function(e){e.preventDefault(),e.stopPropagation(),this.highlight()},onDragleave:function(e){e.preventDefault(),e.stopPropagation(),this.unhighlight()},onDrop:function(e){e.preventDefault(),e.stopPropagation(),this.unhighlight(),e.originalEvent.dataTransfer&&e.originalEvent.dataTransfer.files.length&&this.getWidget().loadContentWithFileUpload(e.originalEvent.dataTransfer.files[0],this.$el)},getWidget:function(){var e=new n;return e.once("contentLoad",this.onWidgetContentLoad.bind(this)),e},highlight:function(){this.$el.addClass("highlight")},unhighlight:function(){this.$el.removeClass("highlight")},onImportFormSubmit:function(e){var t=this;return s(o.mark(function i(){return o.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(!t.productsCollection){i.next=3;break}return i.next=3,t.productsCollection.addQuickAddRows(e);case 3:case"end":return i.stop()}},i)}))()}});return l}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/app/views/search-autocomplete-view.js":function(e,t,i){"use strict";i.r(t);i("../node_modules/core-js/modules/es.array.concat.js"),i("../node_modules/core-js/modules/es.object.assign.js"),i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.filter.js");var n=i("./bundles/oroui/js/extend/backbone.js"),o=i.n(n),s=i("./bundles/oroui/js/extend/jquery.js"),r=i.n(s),a=i("./bundles/oroui/js/extend/underscore.js"),l=i.n(a),u=i("./bundles/oroui/js/app/views/base/view.js"),c=i.n(u),d=i("./bundles/fosjsrouting/js/router.js"),p=i.n(d),h=i("../node_modules/@oroinc/oro-webpack-config-builder/loader/tpl-loader.js!./bundles/oroproduct/templates/search-autocomplete.html"),_=i.n(h),m=(i("../node_modules/jquery-ui/ui/tabbable.js"),c.a.extend({optionNames:c.a.prototype.optionNames.concat(["template","delay","charLimit","resultsLimit","resultsNumber","autocompleteRoute"]),delay:200,charLimit:2,template:_.a,autocompleteRoute:"oro_product_frontend_product_search_autocomplete",$popup:null,searchXHR:null,events:{change:"_onInputChange",keyup:"_onInputChange",focus:"_onInputRefresh",keydown:"_onKeyDown"},previousValue:"",autocompleteItems:'[role="option"]',constructor:function e(t){e.__super__.constructor.call(this,t)},initialize:function(e){this.comboboxId="combobox-".concat(this.cid),this.$el.attr({role:"combobox",autocomplete:"off","aria-haspopup":!0,"aria-expanded":!1,"aria-autocomplete":"list","aria-controls":this.comboboxId}),this.renderSuggestions=l.a.debounce(this.renderSuggestions.bind(this),this.delay),r()("body").on("click".concat(this.eventNamespace()),this._onOutsideAction.bind(this)),m.__super__.initialize.call(this,e)},getInputString:function(){return this.$el.val()},getTemplateData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{inputString:this.getInputString(),comboboxId:this.comboboxId})},dispose:function(){this.disposed||(this.close(),this.$el.attr("aria-expanded",null),r()("body").off(this.eventNamespace()),m.__super__.dispose.call(this))},close:function(){this.$popup&&(this.$popup.remove(),this.$popup=null,this.$el.attr({"aria-expanded":!1,"aria-activedescendant":null}),this.undoFocusStyle())},hideCombobox:function(){this.$popup&&(this.$el.attr({"aria-expanded":!1,"aria-activedescendant":null}),this.$popup.hide(),this.gerSelectedOption().removeAttr("aria-selected"),this.undoFocusStyle())},showCombobox:function(){this.$popup&&this.$popup.show()},hasSelectedOption:function(){return this.gerSelectedOption().length>0},getAutocompleteItems:function(){return this.$el.next().find(this.autocompleteItems)},gerSelectedOption:function(){return this.getAutocompleteItems().filter(function(e,t){return"true"===r()(t).attr("aria-selected")})},getNextOption:function(){var e=this.getAutocompleteItems(),t=this.gerSelectedOption();return 0===t.length||e.length-1===e.index(t)?e.first():e.eq(e.index(t)+1)},getPreviousOption:function(){var e=this.getAutocompleteItems(),t=this.gerSelectedOption();return 0===t.length||0===e.index(t)?e.last():e.eq(e.index(t)-1)},goToOption:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"down",t=this.getAutocompleteItems(),i="down"===e?this.getNextOption():this.getPreviousOption();this.showCombobox(),t.attr("aria-selected",!1),i.attr("aria-selected",!0),this.$el.attr("aria-activedescendant",i.attr("id"))},executeSelectedOption:function(){this.hasSelectedOption()&&this.gerSelectedOption().find(":first-child")[0].click()},_getSearchXHR:function(e){var t=p.a.generate(this.autocompleteRoute,{search:e});return o.a.ajax({dataType:"json",url:t})},render:function(e){return this.close(),this.getInputString().length&&(this.$popup=r()(this.template(this.getTemplateData(e))),this.$el.after(this.$popup),this.$el.attr("aria-expanded",!0),this.getAutocompleteItems().each(function(e,t){r()(t).attr({id:l.a.uniqueId("item-"),"aria-selected":!1}).find(":tabbable").attr("tabindex",-1)})),this},_shouldShowPopup:function(e){return e&&e.length>=this.charLimit},renderSuggestions:function(e){var t=this;this.searchXHR&&this.searchXHR.abort(),this.searchXHR=this._getSearchXHR(e),this.searchXHR.then(this.render.bind(this)).always(function(){delete t.searchXHR})},_onKeyDown:function(e){switch(e.key){case"Tab":case"Escape":case"Esc":this.hideCombobox();break;case"ArrowUp":case"Up":e.preventDefault(),this.goToOption("up");break;case"ArrowDown":case"Down":e.preventDefault(),this.goToOption("down");break;case"Enter":case" ":this.executeSelectedOption()}this.undoFocusStyle()},undoFocusStyle:function(){this.$el.toggleClass("undo-focus",this.hasSelectedOption())},_onInputChange:function(e){var t=this.getInputString();t!==this.previousValue&&(this._shouldShowPopup(t)?this.renderSuggestions(t):this.close(),this.previousValue=t)},_onInputRefresh:function(e){var t=this.getInputString();!t.length&&this.searchXHR&&this.searchXHR.abort(),this._shouldShowPopup(t)?this.renderSuggestions(t):this.close()},_onOutsideAction:function(e){e.target===this.el||this.$popup&&r.a.contains(this.$popup[0],e.target)||this.close()}}));t.default=m},"./bundles/oroproduct/js/app/widget/product-popup-gallery-widget.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/orofrontend/js/app/components/popup-gallery-widget.js"),n=i("./bundles/oroui/js/extend/jquery.js"),o=t.extend({constructor:function(e){o.__super__.constructor.call(this,e)},setDependentSlide:function(e){if(e){var t=n(e.currentTarget).data("gallery-image-index");this.$gallery.slick("slickGoTo",t,!0),this.useThumb()&&this.$thumbnails.slick("slickGoTo",t,!0)}o.__super__.setDependentSlide.call(this,e)}});return o}.call(t,i,t,e))||(e.exports=n)},"./bundles/oroproduct/js/content-processor/product-add-to-dropdown-button.js":function(e,t,i){var n,o;i("../node_modules/core-js/modules/es.array.filter.js"),i("../node_modules/core-js/modules/es.object.to-string.js"),i("../node_modules/core-js/modules/es.array.find.js"),i("../node_modules/core-js/modules/es.array.join.js"),i("../node_modules/core-js/modules/es.regexp.exec.js"),i("../node_modules/core-js/modules/es.string.match.js"),i("../node_modules/core-js/modules/es.array.sort.js"),i("../node_modules/core-js/modules/es.promise.js"),n=[i("./bundles/oroui/js/content-processor/pinned-dropdown-button.js"),i("./bundles/oroui/js/extend/underscore.js"),i("./bundles/oroui/js/mediator.js"),i("./bundles/oroui/js/tools.js"),i("./bundles/oroui/js/app/components/base/component-container-mixin.js")],void 0===(o=function(e,t,i,n,o){"use strict";var s={search:0,important:10,update:20,remove:30,new:40,add:50,direct:60};return e.widget("oroui.productAddToDropdownButtonProcessor",e.oroui.pinnedDropdownButtonProcessor,t.extend(o,{options:{includeButtons:".btn, .dropdown-menu li > a, .dropdown-search",excludeButtons:".dropdown-toggle, button",groupList:!0,sortedList:!0,moreButtonAttrs:{"data-inherit-parent-width":"strictly"}},keyPreffix:"product-add-to-dropdown-button-processor-",modules:[],getLayoutElement:function(){return this.element},_create:function(){var t=this.modules=[];e(this.element).trigger("deferredInitialize",{dropdownWidget:this,productModel:this.options.productModel,callback:function(e){t.push(e)}}),e(this.element).attr("data-product-dropdown-root",""),this._super.apply(this,arguments)},_destroy:function(){delete this.modules,this.disposePageComponents(),this._super()},_renderButtons:function(){this._super.apply(this,arguments),t.each(this.modules,function(e){t.isFunction(e._afterRenderButtons)?e._afterRenderButtons():e.view&&t.isFunction(e.view._afterRenderButtons)&&e.view._afterRenderButtons()}),this.$buttons.filter(":not(.dropdown-search)").length<=1&&this._removeDropdownMenu()},_moreButton:function(){var e=this._super();return!0===this.options.appendToBody&&e.data("container","body"),e},_collectButtons:function(t){return this.$buttons=this._super(t),this.$buttons.each(function(t){var i=e(this).hasClass("direct-link")?"direct":e(this).data("intention")||"add";e(this).attr("data-button-index","").data("order",s[i]).data("button-index",t)}),this.$buttons},_dropdownMenu:function(t){if(!this.options.groupList)return this._super(t);var i=e("<div></div>",{class:"dropdown-menu","aria-labelledby":this._togglerId}).append(this._prepareButtons(t));return i.find(".action-update, .action-remove, .action-new, .action-important").wrapAll('<ul class="items-group"></ul>'),i.find("li.action-add").wrapAll('<ul class="items-group" role="menu"></ul>'),i.find(".items-group").wrapAll('<div class="item-container"></div>'),i},_mainButtons:function(t){var i=t.filter(":not(div.dropdown-search)").get(0);return i?e(i):this._super(t)},_prepareMainButton:function(e){var t=this._super(e);return t.data("clone",e),t.find(".fa").remove(),t},validateForm:function(){var t=e(this.element).closest("form");return!t.data("validator")||t.valid()},_prepareButtons:function(t){t.addClass("dropdown-item");var i=t.filter(".btn").removeClass(function(e,t){return(t.match(/\bbtn(-\S+)?/g)||[]).join(" ")}).wrap(function(){var t=e(this).data("intention")||"add";return"search"===t?'<div class="action-'.concat(t,'"></div>'):'<li role="menuitem" class="action-'.concat(t,'"></li>')}).parent().toArray().sort(function(t,i){return e(t).children().data("order")<e(i).children().data("order")?-1:1});return e(i)}})),e}.apply(t,n))||(e.exports=o)},"./bundles/oroproduct/js/widget/zoom-widget.js":function(e,t,i){var n;void 0===(n=function(e){"use strict";var t=i("./bundles/oroui/js/extend/jquery.js"),n=i("./bundles/oroui/js/extend/underscore.js"),o=i("./bundles/oroui/js/mediator.js");return i("../node_modules/@oroinc/elevatezoom/jquery.elevatezoom.js"),i("../node_modules/jquery-ui/ui/widget.js"),t.widget("oroproduct.zoomWidget",{options:{scrollZoom:!0,zoomWindowPosition:"zoom-container",minZoomWindowWidth:376,maxZoomWindowWidth:700,zoomWindowWidth:376,zoomWindowHeight:376,zoomWindowFadeIn:400,zoomLevel:.4,maxZoomLevel:.8,borderSize:1,borderColour:"#ebebeb",lensBorderColour:"#7d7d7d",lensColour:"#000",lensOpacity:.22},_zoomedImageLoadedState:!1,_zoomedImageLoadedQueue:[],_init:function(){this.options.onZoomedImageLoaded=n.bind(this._onZoomedImageLoaded,this),this.element.on("slider:activeImage",n.bind(function(e,t){this.element.is(t)||this._updateZoomContainer(t)},this));var e=this.element.data("slider:activeImage")||this.element.get(0);o.on("widget:doRefresh",this._reset,this),this._ensureLoadedZoomInit(e)},_ensureLoadedZoomInit:function(e){e.complete?this._zoomInit(e):t(e).one("load",this._zoomInit.bind(this,e))},_zoomInit:function(e){this.element=t(e),this._setZoomWindowSize(e),this.element.elevateZoom(this.options)},_updateZoomContainer:function(e){this._zoomedImageLoadedState?this._reInitZoomContainer(e):this._zoomedImageLoadedQueue.push(function(){this._reInitZoomContainer(e)})},_reInitZoomContainer:function(e){this._removeZoomContainer(),this._zoomInit(e)},_reset:function(){this._updateZoomContainer(this.element.get(0))},_onZoomedImageLoaded:function(){this._zoomedImageLoadedState=!0;for(var e=0;e<this._zoomedImageLoadedQueue.length;e++)"function"==typeof this._zoomedImageLoadedQueue[e]&&n.bind(this._zoomedImageLoadedQueue[e],this)();this._zoomedImageLoadedQueue=[],this._resetImageProperty()},_resetImageProperty:function(){var e=this.element.data("elevateZoom");if(e){var i=e.largeWidth,n=e.largeHeight,o=this.options.zoomWindowWidth,s=this.options.zoomWindowHeight;if(i<=o||n<=s){var r=3*i,a=3*n;e.largeWidth=r,e.largeHeight=a,t(".zoomWindowContainer").remove(),t(".zoomContainer").remove(),e.startZoom()}}},_setZoomWindowSize:function(e){var i=t(e).width(),o=t(e).height(),s=this.options.zoomWindowHeight,r=this.options.maxZoomWindowWidth,a=this.options.minZoomWindowWidth,l=s*i/o;l=(l=l>r?r:l)<a?a:l,this.options.zoomWindowWidth=l,n.isRTL()&&(this.options.zoomWindowOffetx=-l)},_removeZoomContainer:function(){var e=this.element.data("elevateZoom");e&&e.zoomContainer&&(e.zoomContainer.remove(),e.zoomWindow.parent().remove()),this.element.removeData("elevateZoom"),this.element.removeData("zoomImage"),this._unBindZoomEvents()},_unBindZoomEvents:function(){this.element.unbind("mousemove touchmove touchend mousewheel DOMMouseScroll MozMousePixelScroll")},_destroy:function(){this._removeZoomContainer(),t("."+this.element[0].className).off("slider:activeImage"),this._unBindZoomEvents()}}),"zoomWidget"}.call(t,i,t,e))||(e.exports=n)}}]);